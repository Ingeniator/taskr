name: Jenkins Deploy Pipeline
description: Build, test, and deploy via Jenkins jobs (sequential)
cwd: ./tools

steps:
- name: Install dependencies
  run: pip3 install -r requirements.txt -q

- name: Run Jenkins jobs
  run: |
    python3 run_jenkins_jobs.py -c - << 'EOF'
    execution:
      mode: sequential
      fail_fast: true
      timeout: 1800

    jobs:
    - name: "my-project/build"
      parameters:
        BRANCH: "main"
        ENV: "staging"

    - name: "my-project/test"
      parameters:
        SUITE: "integration"

    - name: "my-project/deploy"
    EOF
